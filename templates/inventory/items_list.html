{% extends "_base.html" %}
{% block content %}
<div class="max-w-5xl mx-auto p-4">
  <h1 class="text-2xl font-semibold mb-4">Items</h1>
  <div class="mb-4 flex gap-2">
    <a href="{% url 'item_create' %}" class="px-4 py-2 bg-green-600 text-white rounded">Add Item</a>
    <a href="{% url 'items_bulk_upload' %}" class="px-4 py-2 border rounded">Bulk Upload</a>
  </div>
  <form id="filters" class="flex flex-wrap gap-2 mb-4">
    <input
      type="text"
      name="q"
      placeholder="Search items..."
      class="border rounded p-2 flex-grow"
      value="{{ q }}"
      hx-get="{% url 'items_table' %}"
      hx-target="#items_table"
      hx-trigger="keyup changed delay:300ms"
      hx-include="#filters"
    />
    <select name="category" class="border rounded p-2"
            hx-get="{% url 'items_table' %}" hx-target="#items_table" hx-trigger="change" hx-include="#filters">
      <option value="">All Categories</option>
      {% for cat in categories %}
      <option value="{{ cat }}" {% if cat == category %}selected{% endif %}>{{ cat }}</option>
      {% endfor %}
    </select>
    <select name="subcategory" class="border rounded p-2"
            hx-get="{% url 'items_table' %}" hx-target="#items_table" hx-trigger="change" hx-include="#filters">
      <option value="">All Subcategories</option>
      {% for sub in subcategories %}
      <option value="{{ sub }}" {% if sub == subcategory %}selected{% endif %}>{{ sub }}</option>
      {% endfor %}
    </select>
    <select name="active" class="border rounded p-2"
            hx-get="{% url 'items_table' %}" hx-target="#items_table" hx-trigger="change" hx-include="#filters">
      <option value="">All</option>
      <option value="1" {% if active == '1' %}selected{% endif %}>Active</option>
      <option value="0" {% if active == '0' %}selected{% endif %}>Inactive</option>
    </select>
  </form>
  <div id="items_table"
       hx-get="{% url 'items_table' %}"
       hx-trigger="load"
       hx-include="#filters">
  </div>
</div>
{% endblock %}
